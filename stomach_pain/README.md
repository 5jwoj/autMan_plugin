# 肚子疼记录插件 😊

> 一个爸爸为了记录孩子肚子疼情况而开发的autMan插件

[返回主页](../README.md)

## 💝 开发初衷

作为一名父亲,我发现孩子经常说肚子疼,但很难记住每次发生的时间和频率。医生询问病史时,我们也很难准确回忆。

于是我开发了这个简单的插件,每当孩子肚子疼时,我只需要在手机上发送"肚子疼"三个字,就能自动记录下时间。日积月累,就能清楚地看到孩子肚子疼的规律,帮助我们更好地了解孩子的健康状况。

## ✨ 功能特性

- 📝 **一键记录** - 发送"肚子疼"即可记录精确时间
- 📊 **时间轴视图** - 树状结构展示每天的记录
- 📈 **智能分页** - 自动显示月度摘要,默认展示最近7天
- 🎨 **彩色标记** - 用不同颜色区分频次(🟢1次 🟡2次 🟠3次 🔴4次+)
- 💾 **数据持久化** - 基于autMan的bucket存储,永久保存
- 👤 **用户隔离** - 每个用户的数据独立存储

## 🚀 快速开始

### 安装

1. 下载 `肚子疼.js` 文件
2. 上传到autMan服务器的 `/root/autman/plugin/replies/` 目录
3. 重启autMan

```bash
# 上传插件
scp 肚子疼.js root@你的服务器:/root/autman/plugin/replies/

# 重启autMan
pm2 restart autman
```

### 使用方法

| 指令 | 功能 |
|------|------|
| `肚子疼` | 记录当前时间 |
| `肚子疼记录` | 查看时间轴视图 |
| `清空肚子疼记录` | 清空所有记录 |
| `肚子疼帮助` | 显示帮助信息 |

## 📊 显示效果

### 少量数据
```
📊 肚子疼记录 (共3条)
━━━━━━━━━━━━━━━━━━━━━━━━━

🗓️ 1月2日 🟢
  └─ 12:20
  📊 当天1次

🗓️ 1月5日 🟡
  ├─ 09:15
  └─ 14:30
  📊 当天2次

━━━━━━━━━━━━━━━━━━━━━━━━━
📈 总体统计
• 记录时段: 2026-01-02 至 2026-01-05
• 记录天数: 2天 (跨度4天)
• 总计次数: 3次
• 平均频率: 0.75次/天
```

### 大量数据(自动显示月度摘要)
```
📊 肚子疼记录 (共50条)
━━━━━━━━━━━━━━━━━━━━━━━━━

📈 月度统计摘要
▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔▔
2026年01月: 30次
2025年12月: 20次

📅 最近7天详细记录
━━━━━━━━━━━━━━━━━━━━━━━━━
...
```

## 🔧 技术规格

- **平台**: autMan
- **语言**: JavaScript (ES6+)
- **存储**: autMan bucketGet/Set API
- **版本**: v1.4.0

## 📝 版本历史

### v1.4.0 (2026-01-02)
- ✨ 采用时间轴视图,更直观易读
- ✨ 添加智能分页(默认显示最近7天)
- ✨ 大数据量时自动显示月度摘要

### v1.3.0
- 🎨 尝试日历UI设计

### v1.2.0
- ✨ 新增记录查询功能

### v1.1.2
- 🐛 修复清空功能bug

### v1.0.0
- 🎉 首个版本发布

## 🛠️ 开发过程

这个插件的开发经历了多次迭代:
1. 最初尝试使用ES5同步API(失败)
2. 研究autMan的异步API结构
3. 发现autMan使用全局注入而非require
4. 尝试日历视图(对齐问题)
5. 最终采用时间轴视图(完美解决)

详细开发过程请查看 [开发过程.md](开发过程.md)

## 💡 为什么开发这个插件?

孩子健康是每个父母最关心的事。通过记录这些看似琐碎的信息,我们可以:

- 📊 **发现规律** - 是否与饮食、作息有关?
- 🏥 **就医参考** - 向医生提供准确的病史
- 📈 **趋势分析** - 是否在好转或加重?
- 💝 **用心陪伴** - 用数据守护孩子的健康

## 🤝 贡献

如果您也是关心孩子健康的父母,欢迎:
- 提出改进建议
- 报告bug
- 分享使用经验

## 📄 许可

本插件免费使用,代码开源。

---

**愿所有的孩子都健康快乐成长** ❤️
